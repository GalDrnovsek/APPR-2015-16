---
title: "Poročilo pri predmetu Analiza podatkov s programom R"
author: "Gal Drnovšek"
output:
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
  word_document: default
---

```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
# Če želimo nastaviti pisave v PDF-ju, odkomentiramo
# in sledimo navodilom v programu.
#source("fontconfig.r", encoding = "UTF-8")

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding = "UTF-8")
```

# Izbira teme
Odločil sem se, da bom analiziral statistiko šahovskih otvoritev, ki so bile odigrane v več kot 2 milijonih šahovskih partij. Cilj je izvedeti, katere otvoritve so statistično najboljše za igralce z belimi in igralce s črnimi figurami ter v katerih otvoritvah je največji delež remijev. Dodatno me zanima še, katere države imajo največ velemojstrov. Podatke sem pridobil na:

* http://www.becomeawordgameexpert.com/stats.htm

* https://en.wikipedia.org/wiki/List_of_chess_grandmasters_by_country

* https://en.wikipedia.org/wiki/List_of_countries_by_population_(United_Nations)

V kasnejših fazah bom narisal zemljevid, ki bo prikazoval, katere države imajo največ velemojstrov per capita.

***

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz, echo=FALSE,results='hide', message=FALSE}
source("uvoz/uvoz.r", encoding = "UTF-8")
```

## HTML podatki

Iz prve spletne strani sem uvozil nekaj tabel, iz katerih sem dobil podatke o deležih belih zmag, črnih zmag in remijev za posamezne otvoritve.
Spodnja tabele predstavlja statistiko vseh šahovskih otvoritev in podotvoritev. Ker ima 290 vrstic, vzemimo le začetek:

```{r,echo=FALSE,message=FALSE}
kable(head(Chess_opening_statistics))
```

Ta tabela ima 4 stolpce: ime otvoritve, delež zmag igralcev z belimi figurami, delež remijev in delež zmag igralcev s črnimi figurami.

Oglejmo si tabelo, ki predstavlja otvoritve z največjimi deleži zmag igralcev z belimi figurami. 

```{r,echo=FALSE,message=FALSE}
kable(Best_white_openings)
```

Ta tabela ima enake stolpce kot zgornja, le da je dodan še stolpec, ki predstavlja povprečno število točk od 100 za igralce z belimi figurami za posamezno otvoritev. V tej tabeli je le 10 tistih otvoritev, ki kažejo na najboljše rezultate za igralce z belimi figurami glede na doseženo število točk. 
Graf za to tabelo sem naredil v odvisnosti od njenega zadnjega stolpca:

```{r,echo=FALSE,message=FALSE}
graf_white
```

Vidi se, da je po tem kriteriju najboljša otvoritev za belega Damin gambit, ki v povprečju doseže 58 točk od 100.

Enake stolpce ima tudi tabela, v kateri je 10 najboljših otvoritev za igralce s črnimi figurami.
Graf za to tabelo izgleda takole:

```{r,echo=FALSE,message=FALSE}
graf_black
```

Opazimo, da najboljše rezultate igralcem s črnimi figurami prinašata Sicilijanska obramba in Nimzo-Indijka, vendar v vsaki od teh otvoritev igralci s črnimi figurami v povprečju dosežejo le 48,5 točk od 100, kar je manj kot 50%.

V tabeli za 10 tistih partij, ki se največkrat končajo z remijem, sta 2 stolpca: ime otvoritve in povprečno število remijev na 100 odigranih partij.
Graf za partije z največ remiji:

```{r,echo=FALSE,message=FALSE}
graf_draws
```

Otvoritvi z največjim deležem remijev sta Damina indijska obramba in Bogo-indijska obramba, pri katerih je povprečno število remijev na 100 partij enako 42.

Iz druge spletne strani sem uvozil tabelo, v kateri so vse države, v katerih so vsaj 3 trenutno aktivni velemojstri. Stolpci te tabele so ime države, število trenutno aktivnih velemojstrov in število vseh velemojstrov. 
Iz te tabele sem naredil novo tabelo, ki zajema 10 držav, ki imajo največje število velemojstrov:

```{r,echo=FALSE,message=FALSE}
kable(topvelemojstri)
```

Iz te tabele sem naredil še graf glede na število aktivnih velemojstrov:

```{r,echo=FALSE,message=FALSE}
graf_GMs
```

Po pričakovanjih je država za največ aktivnimi velemojstri Rusija(158), sledita pa ji Nemčija in Ukrajina.



